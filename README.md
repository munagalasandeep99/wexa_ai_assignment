Wexa AI Next.js Application
This repository contains a Next.js application created with npx create-next-app@latest, containerized using Docker, automated with GitHub Actions for building and pushing to GitHub Container Registry (GHCR), and deployed to a local Kubernetes cluster using Minikube. This project fulfills the requirements of the DevOps Internship Assessment.
Prerequisites
To set up and run this project, ensure you have the following installed:

Node.js (v16 or higher)
Docker (for building and running the container)
Minikube (for local Kubernetes deployment)
kubectl (for interacting with the Kubernetes cluster)
Git (for cloning the repository)
A GitHub account with access to GitHub Container Registry (GHCR)

Setup Instructions

Clone the Repository
git clone https://github.com/munagalasandeep99/<repository-name>.git
cd <repository-name>


Install DependenciesNavigate to the project directory and install the Next.js application dependencies:
npm install


Run Locally (Development Mode)Start the Next.js application in development mode:
npm run dev

The application will be available at http://localhost:3000.

Build and Run Locally with Docker

Build the Docker image:docker build -t wexa-ai-app:latest .


Run the Docker container:docker run -p 3000:3000 wexa-ai-app:latest

The application will be accessible at http://localhost:3000.



GitHub Actions Workflow
The repository includes a GitHub Actions workflow (.github/workflows/docker-build-push.yml) that:

Triggers on push to the main branch.
Builds the Docker image for the Next.js application.
Tags the image with latest, the GitHub Actions build number, and the short commit SHA.
Pushes the image to GitHub Container Registry (GHCR).

To configure the workflow:

Ensure you have a Personal Access Token (PAT) with write:packages scope.
Add the PAT as a repository secret named GH_PAT in GitHub under Settings > Secrets and variables > Actions.
The workflow will automatically build and push the image to:ghcr.io/munagalasandeep99/wexa_ai_assignment:latest
ghcr.io/munagalasandeep99/wexa_ai_assignment:<build-number>
ghcr.io/munagalasandeep99/wexa_ai_assignment:<short-sha>



Deploying to Minikube

Start MinikubeEnsure Minikube is running:
minikube start


Apply Kubernetes ManifestsThe Kubernetes manifests are located in the k8s/ directory:

deployment.yaml: Defines a Deployment with 2 replicas, liveness and readiness probes, and pulls the image from ghcr.io/munagalasandeep99/wexa_ai_assignment:latest.
service.yaml: Exposes the application via a NodePort service, mapping port 80 to the container's port 3000.

Apply the manifests:
kubectl apply -f k8s/deployment.yaml
kubectl apply -f k8s/service.yaml


Access the Application

Expose the service using Minikube:minikube service wexa-ai-service

This will open the application in your default browser or provide a URL (e.g., http://<minikube-ip>:<node-port>).
Alternatively, use port-forwarding:kubectl port-forward service/wexa-ai-service 3000:80

The application will be available at http://localhost:3000.



Accessing the Deployed Application

After deploying to Minikube, use the minikube service wexa-ai-service command to get the application URL.
If using port-forwarding, access the application at http://localhost:3000.
The service is exposed via NodePort, so the Minikube URL will include a dynamically assigned node port (check with kubectl get services).

Repository Structure

pages/: Next.js application code (generated by npx create-next-app@latest)
public/: Static assets for the Next.js application
Dockerfile: Multi-stage Docker configuration for building and running the application
.github/workflows/docker-build-push.yml: GitHub Actions workflow for building and pushing the Docker image
k8s/: Kubernetes manifests
deployment.yaml: Kubernetes Deployment configuration
service.yaml: Kubernetes Service configuration


README.md: This documentation file

GitHub Container Registry
The Docker image is pushed to GHCR at:
ghcr.io/munagalasandeep99/wexa_ai_assignment:latest
ghcr.io/munagalasandeep99/wexa_ai_assignment:<build-number>
ghcr.io/munagalasandeep99/wexa_ai_assignment:<short-sha>

Troubleshooting

Minikube Access Issues: Ensure Minikube is running and the service is correctly exposed. Check pod status with kubectl get pods and service details with kubectl get services.
Docker Build Fails: Verify Docker is running and the Dockerfile syntax is correct. Ensure all dependencies are included in package.json.
GitHub Actions Errors: Ensure the GH_PAT secret is correctly configured with write:packages scope.
Image Pull Issues: Verify the image exists in GHCR and the imagePullPolicy: Always is set in deployment.yaml.

For further assistance, refer to the official documentation for Next.js, Docker, GitHub Actions, and Minikube.